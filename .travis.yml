sudo: true
os: osx
osx_image: xcode8
node_js:
  - "lts/*"
language: objective-c

before_install:
  - ./fix-cert.sh
  - nvm install 8
  - nvm use 8
  - echo -e "machine github.com\n  login $CI_USER_TOKEN" >> ~/.netrc

install: 
  - npm install -g npm
  - npm install -g cordova ionic
  - sudo gem install fastlane

script:
  - cd readmyage
  - ../setversion.py 0.0.1 $TRAVIS_BUILD_NUMBER config.xml
  - npm install
  - ionic login $IONIC_EMAIL $IONIC_PASS
  - ionic cordova resources
  - ionic cordova prepare
  - ionic build
  - fastlane setup
  - cordova build --release --developmentTeam=Q2465CX346 --provisioningProfile="508d8b26-013a-4ddd-95f8-4b2ba484bf45" ios
  - fastlane beta